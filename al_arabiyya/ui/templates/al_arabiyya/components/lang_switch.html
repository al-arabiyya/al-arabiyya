{% load i18n wagtailcore_tags %}

<div
  class="tooltip tooltip-left tooltip-primary rtl:tooltip-right"
  data-tip="{% trans 'Language' %}"
>
  <button
    popovertarget="language"
    style="anchor-name: --language"
    class="btn btn-square btn-soft btn-sm btn-primary md:btn-md 2xl:btn-lg"
  >
    <i data-lucide="languages" class="size-4 lg:size-6"></i>

    <span class="sr-only">{% trans 'Language' %}</span>
  </button>

  <ul
    popover
    id="language"
    style="position-anchor: --language"
    class="menu dropdown dropdown-bottom bg-base-100/75 dark:bg-base-100/50 dropdown-left rounded-box backdrop-blur-3xl text-base-content shadow-xl rtl:dropdown-right"
  >
    <li class="menu-title">{% trans 'Language' %}</li>

    {% if page %}
    <!---->
    {% for language_code, language_name in LANGUAGES %}
    <!---->
    {% get_language_info for language_code as lang %}
    <li class="tooltip tooltip-primary" data-tip="{{ lang.name_translated }}">
      {% language language_code %}
      <a
        rel="alternate"
        hreflang="{{ language_code }}"
        href="{% pageurl page.localized %}"
        class="flex flex-row items-center justify-between gap-6"
      >
        <span class="flex items-center gap-4">
          {{ language_name }} - ({{ lang.name_local }})
        </span>

        {% if language_code == LANGUAGE_CODE %}
        <span>
          <i data-lucide="check" class="size-4 lg:size-6"></i>
          <span class="sr-only">{% trans 'Current' %}</span>
        </span>
        {% endif %}
      </a>
      {% endlanguage %}
    </li>
    {% endfor %}
    <!---->
    {% else %}
    <li class="hidden">
      <form method="post" id="lang-form" action="{% url 'set_language' %}">
        {% csrf_token %}
        <input name="next" type="hidden" value="{{ redirect_to }}" />
      </form>
    </li>

    {% for language_code, language_name in LANGUAGES %}
    <!---->
    {% get_language_info for language_code as lang %}
    <li class="tooltip tooltip-primary" data-tip="{{ lang.name_translated }}">
      <label class="flex flex-row items-center justify-between gap-6">
        <div class="flex flex-row items-center gap-2">
          <input
            type="submit"
            class="hidden"
            name="language"
            form="lang-form"
            value="{{ language_code }}"
            aria-label="{{ lang.name_local }} ({{ lang.code }})"
          />
          <span>{{ language_name }} - ({{ lang.name_local }})</span>
        </div>
        {% if language_code == LANGUAGE_CODE %}
        <i data-lucide="check" class="size-4 lg:size-6"></i>
        {% endif %}
      </label>
    </li>
    {% endfor %}
    <!---->
    {% endif %}
  </ul>
</div>
